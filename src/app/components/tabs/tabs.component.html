<div class="tabs-wrapper space-y-4">
  <div class="tabs-header flex flex-wrap items-center gap-2">
    <div
      class="tab-pill flex items-center gap-2"
      *ngFor="let tab of tabsField.tabs; let t = index"
      [class.active]="tabsField.activeTabIndex === t"
    >
      <button
        type="button"
        class="tab-pill__btn"
        (click)="onSetActiveTab(t)"
      >
        {{ tab.title }}
      </button>
      <input
        *ngIf="tabsField.activeTabIndex === t"
        class="tab-pill__input form-input"
        [value]="tab.title"
        (click)="$event.stopPropagation()"
        (input)="onUpdateTabTitle(t, $any($event.target).value)"
      />
      <button
        type="button"
        class="btn btn-outline-danger btn-xxs"
        (click)="onDeleteTab(t)"
        [disabled]="tabsField.tabs.length === 1"
      >
        Ã—
      </button>
    </div>
    <button class="btn btn-outline-primary btn-xs" type="button" (click)="onAddTab()">+ Add Tab</button>
  </div>

  <ng-container *ngIf="getActiveTab() as activeTab">
    <div
      class="tab-dropzone border border-defaultborder rounded p-3 bg-bodybg2 dark:bg-bodybg"
      cdkDropList
      [id]="getTabListId(activeTab)"
      [cdkDropListData]="activeTab.fields"
      [cdkDropListConnectedTo]="getConnectedTargets(getTabListId(activeTab))"
      (cdkDropListDropped)="onDropOnTab(getActiveTabIndex(), $event)"
    >
      <div *ngIf="!activeTab.fields.length" class="text-xs italic text-mutedtextcolor py-4 text-center">
        Drop fields for {{ activeTab.title }} here
      </div>

      <div
        *ngFor="let innerField of activeTab.fields; let innerIndex = index"
        class="tab-inner-field border border-defaultborder rounded-md p-2 mb-2 bg-white dark:bg-bodybg shadow-sm"
        cdkDrag
      >
        <div class="inner-field-toolbar flex items-center justify-between mb-2">
          <span class="text-[11px] uppercase tracking-wide text-defaulttextcolor">
            {{ innerField.label }}
          </span>
          <button
            type="button"
            class="text-xs text-white bg-red-500 hover:bg-red-600 rounded-full w-5 h-5 flex items-center justify-center"
            (click)="onDeleteNestedField(getActiveTabIndex(), innerIndex)"
          >&times;</button>
        </div>

        <ng-container [ngSwitch]="innerField.type">
          <input *ngSwitchCase="'text'" type="text" placeholder="Enter text" class="form-input w-full" />
          <select *ngSwitchCase="'dropdown'" class="form-select w-full">
            <option *ngFor="let opt of innerField.options">{{ opt }}</option>
          </select>
          <div *ngSwitchCase="'checkbox'" class="flex items-center gap-2">
            <input type="checkbox" class="form-checkbox" />
            <span>Check me</span>
          </div>
        </ng-container>
      </div>
    </div>
  </ng-container>
</div>

